# Generating and detecting new malware samples using Deep Neural Networks and Generative models

# Abstract
By increasing the use of computers and the Internet, malware detection is one of the most critical issues in computer security. Current researches use machine learning methods that require a great deal of knowledge about malware characteristics to extract proper features. In some cases,  data deformation has been used to solve the problem, like converting to image or music. However, these processes can be time-consuming and require significant amounts of data. In this paper, we propose MalGan for detection and generation of new malware samples based on raw byte code which use only a short piece of the header for this purpose. Convolutional Neural Network was utilized as a supervised feature learning to automatically extract high-level features from the original feature set.
Moreover, new signatures of malware sample are generated based on the limited number of existing samples for oversampling the training set. Due to the limitations of Generative Adversarial Network proposed by Goodfellow in 2014, Boundary seeking Generative Adversarial Network was employed for this purpose. Thus, even with limited amounts of malware samples, a significant amount of unknown malware samples will be detected with a high detection rate. In order to capture short-term and long-term dependency of features, we employ an attention-based model; a combination of Convolutional Neural Network and Long Short Term Memory . The Attention mechanism also improves the performance of the model by increasing or decreasing attention to certain parts of the features. The experimental results indicate that our proposed MalGan is the method of choice, as it offers a higher detection rate compared to the oversampling and malware detection algorithms in the literature.

# Installations:
Python - 3.6

# Python Libraries :
  - Tensorflow
  - Keras
  - Numpy
  - sklearn
  - matplotlib
# Steps
  - Update the paths in .py files according to the location of the files.
  - Run the header_extraction.py file for malware and benign file separately. After running you should see "extracted_header" files       created.
  - Run high_level_feature_extraction.py to extract new feature using Convolutional Neural Network.
  - Run BGAN.py to generate new malware samples, extracted features for malware samples in previouse step are the training data for this step.
  - oversample the training set with generated samples by BGAN and run deepNetwork.py with malware and benign files for classification purpose.
 
 # Results
 - Display the distribution of the real and generated malware and non-malicious files
 ![alt text](https://github.com/zahra7394/malware_detection/blob/master/images/123.jpg?raw=true "Display the distribution of the real and generated malware and non-malicious files")
